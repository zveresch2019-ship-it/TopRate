<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–æ–ø–†–µ–π—Ç - –ü—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .title {
            font-size: 24px;
            font-weight: bold;
            margin: 0;
        }
        
        .subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin: 5px 0 0 0;
        }
        
        .content {
            padding: 20px;
        }
        
        .section {
            margin-bottom: 20px;
        }
        
        .section h3 {
            margin-bottom: 10px;
            color: #333;
            font-size: 16px;
        }
        
        .player-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .player-name {
            font-weight: 500;
        }
        
        /* –°–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–µ–ª–æ—á–µ–∫ –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ —á–∏—Å–ª–∞ */
        .no-spinner::-webkit-outer-spin-button,
        .no-spinner::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .no-spinner {
            -moz-appearance: textfield;
        }
        
        .player-rating {
            font-weight: bold;
            color: #4CAF50;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .btn-primary {
            background: #4CAF50;
            color: white;
        }
        
        .btn-secondary {
            background: #2196F3;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .match-result {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 12px;
        }
        
        .rating-change {
            font-weight: bold;
            color: #4CAF50;
        }
        
        .rating-change.negative {
            color: #f44336;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 300px;
        }
        
        .modal h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 15px;
        }
        
        .btn-cancel {
            background: #6c757d;
            color: white;
        }
        
        /* –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .login-title {
            font-size: 28px;
            font-weight: bold;
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .login-subtitle {
            font-size: 14px;
            color: #666;
            margin: 0 0 30px 0;
        }
        
        .login-form {
            text-align: left;
        }
        
        .btn-login {
            width: 100%;
            margin-bottom: 10px;
        }
        
        .btn-language {
            width: 100%;
        }
        
        /* –ö–æ–º–∞–Ω–¥—ã */
        .teams-section {
            margin-top: 20px;
        }
        
        .teams-container {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            width: 100%;
            box-sizing: border-box;
        }
        
        .team-section {
            flex: 1;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            min-width: 0;
            max-width: calc(50% - 5px);
            box-sizing: border-box;
        }
        
        .team-a {
            border-color: #4CAF50;
        }
        
        .team-b {
            border-color: #2196F3;
        }
        
        .team-title {
            font-weight: bold;
            margin-bottom: 8px;
            text-align: center;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .team-a .team-title {
            color: #4CAF50;
        }
        
        .team-b .team-title {
            color: #2196F3;
        }
        
        .team-players {
            min-height: 60px;
            border: 1px dashed #ccc;
            border-radius: 4px;
            padding: 0;
            margin-bottom: 10px;
            overflow: hidden;
            max-width: 100%;
        }
        
        .team-players-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            table-layout: fixed;
            max-width: 100%;
        }
        
        .team-players-table th {
            background: #f8f9fa;
            padding: 4px 6px;
            text-align: center;
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #ddd;
            font-size: 10px;
        }
        
        .team-players-table td {
            padding: 4px 6px;
            border-bottom: 1px solid #eee;
            vertical-align: middle;
        }
        
        .team-players-table th:first-child,
        .team-players-table td:first-child {
            text-align: center;
            width: 25px;
            font-weight: bold;
            color: #666;
        }
        
        .team-players-table th:nth-child(2),
        .team-players-table td:nth-child(2) {
            text-align: left;
            font-weight: bold;
            width: 50px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .team-players-table th:nth-child(3),
        .team-players-table td:nth-child(3) {
            text-align: right;
            width: 45px;
            color: #666;
        }
        
        .team-players-table th:last-child,
        .team-players-table td:last-child {
            text-align: center;
            width: 25px;
        }
        
        .team-players-table tr:last-child td {
            border-bottom: none;
        }
        
        .remove-player {
            background: #f44336;
            color: white;
            border: none;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            cursor: pointer;
            font-size: 8px;
            padding: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .no-players {
            text-align: center;
            color: #999;
            font-style: italic;
            padding: 20px;
        }
        
        .team-stats {
            text-align: center;
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }
        
        .team-total-rating {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 4px;
        }
        
        .team-change-display {
            font-size: 11px;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 4px;
        }
        
        .team-change-display.positive {
            background: #d4edda;
            color: #155724;
        }
        
        .team-change-display.negative {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ */
        .available-players {
            margin-top: 20px;
        }
        
        .available-players h3 {
            margin-bottom: 10px;
        }
        
        .player-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #f9f9f9;
            margin-bottom: 4px;
            font-size: 14px;
        }
        
        .player-item-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .player-number {
            width: 20px;
            text-align: center;
            font-weight: bold;
            color: #666;
            font-size: 12px;
        }
        
        .player-item-name {
            font-weight: bold;
            flex: 1;
        }
        
        .player-item-rating {
            font-size: 0.9em;
            color: #666;
            min-width: 50px;
            text-align: left;
            margin-right: 10px;
        }
        
        .player-actions {
            display: flex;
            gap: 5px;
        }
        
        .team-button {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: none;
            color: white;
            font-weight: bold;
            font-size: 10px;
            cursor: pointer;
        }
        
        .team-a-button {
            background: #4CAF50;
        }
        
        .team-b-button {
            background: #2196F3;
        }
        
        .team-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        /* –ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—Ç—á–µ–π */
        .match-compact {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 8px;
            background: #f9f9f9;
        }
        
        .match-date {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .match-teams-compact {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }
        
        .team-compact {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }
        
        .team-name-compact {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .team-change {
            font-weight: bold;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .team-change.positive {
            background: #d4edda;
            color: #155724;
        }
        
        .team-change.negative {
            background: #f8d7da;
            color: #721c24;
        }
        
        .match-score-compact {
            font-weight: bold;
            font-size: 16px;
            color: #333;
            padding: 0 10px;
        }
        
        .match-actions {
            margin-top: 8px;
            text-align: center;
        }
        
        .btn-small {
            padding: 4px 8px;
            font-size: 12px;
        }
        
        /* –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞ */
        .calculation-params {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
        }
        
        .param-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
            border-bottom: 1px solid #eee;
        }
        
        .param-item:last-child {
            border-bottom: none;
        }
        
        .param-name {
            font-weight: bold;
            color: #333;
            font-size: 12px;
        }
        
        .param-value {
            font-weight: bold;
            color: #007bff;
            font-size: 12px;
        }
        
        /* –ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π */
        .match-item {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 10px;
            background: #f9f9f9;
        }
        
        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .match-score {
            font-weight: bold;
            font-size: 1.1em;
            color: #333;
        }
        
        .match-date {
            color: #666;
            font-size: 0.9em;
        }
        
        .match-teams {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .team-info {
            flex: 1;
            text-align: center;
        }
        
        .team-name {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .team-players {
            font-size: 0.9em;
            color: #666;
        }
        
        .match-changes {
            border-top: 1px solid #eee;
            padding-top: 8px;
            font-size: 0.9em;
        }
        
        .change-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2px;
        }
        
        .change-positive {
            color: #4CAF50;
        }
        
        .change-negative {
            color: #f44336;
        }
        
        /* –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞ */
        .calculation-params {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
        }
        
        .param-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .param-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .param-name {
            font-weight: bold;
            color: #333;
        }
        
        .param-value {
            color: #666;
            font-family: monospace;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        /* –í–∫–ª–∞–¥–∫–∏ */
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            margin-bottom: 20px;
        }
        
        .tab-button {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab-button:hover {
            background: #e9ecef;
            color: #495057;
        }
        
        .tab-button.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            font-weight: bold;
            color: #333;
        }
        
        .stat-value {
            color: #007bff;
            font-weight: bold;
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-name {
            font-weight: bold;
            color: #333;
        }
        
        .btn-sm {
            padding: 4px 8px;
            font-size: 12px;
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid #6c757d;
            color: #6c757d;
        }
        
        .btn-outline:hover {
            background: #6c757d;
            color: white;
        }
        
        /* –°–µ–∑–æ–Ω—ã */
        .season-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ */
        .btn-export {
            width: 100%;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–∞–±–ª–∏—Ü—ã */
        .table-container {
            overflow-x: auto;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* –¢–∞–±–ª–∏—Ü–∞ –∏–≥—Ä–æ–∫–æ–≤ */
        .players-table {
            width: 100%;
            max-width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            table-layout: fixed;
        }
        
        .players-table th {
            background: #f8f9fa;
            padding: 8px 4px;
            text-align: left;
            font-weight: bold;
            color: #333;
            border-bottom: 2px solid #dee2e6;
            font-size: 12px;
        }
        
        .players-table td {
            padding: 6px 4px;
            text-align: left;
            border-bottom: 1px solid #eee;
            font-size: 12px;
        }
        
        .players-table td:first-child,
        .players-table th:first-child {
            text-align: center;
            width: 8%;
        }
        
        .players-table td:nth-child(2),
        .players-table th:nth-child(2) {
            width: 25%;
        }
        
        .players-table td:nth-child(3),
        .players-table td:nth-child(4),
        .players-table td:nth-child(5),
        .players-table td:nth-child(6),
        .players-table td:nth-child(7),
        .players-table th:nth-child(3),
        .players-table th:nth-child(4),
        .players-table th:nth-child(5),
        .players-table th:nth-child(6),
        .players-table th:nth-child(7) {
            text-align: center;
            width: 12%;
        }
        
        .players-table tr:hover {
            background: #f8f9fa;
        }
        
        .players-table .positive {
            color: #28a745;
            font-weight: bold;
        }
        
        .players-table .negative {
            color: #dc3545;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ -->
    <div id="login-page" class="login-container">
        <div class="login-box">
            <h1 class="login-title">üèÜ –¢–æ–ø–†–µ–π—Ç</h1>
            <p class="login-subtitle">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–º —Å–ø–æ—Ä—Ç–µ</p>
            
            <div class="login-form">
                <div class="form-group">
                    <label for="login-username" id="login-username-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="login-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" maxlength="20">
                </div>
                <div class="form-group">
                    <label for="login-password" id="login-password-label">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="login-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" maxlength="20">
                </div>
                <button class="btn btn-primary btn-login" onclick="login()" id="login-btn">–í–æ–π—Ç–∏</button>
                <button class="btn btn-outline btn-language" onclick="toggleLanguage()" id="login-language-btn">EN</button>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app-container" class="container" style="display: none;">
        <div class="header">
            <div class="header-top">
                <h1 class="title">üèÜ –¢–æ–ø–†–µ–π—Ç</h1>
                <div class="user-info">
                    <span class="user-name" id="user-name">Test1</span>
                    <button class="btn btn-sm btn-outline" onclick="logout()" id="logout-btn">–í—ã—Ö–æ–¥</button>
                    <button class="btn btn-sm btn-outline" onclick="toggleLanguage()" id="language-btn">EN</button>
                </div>
            </div>
            <p class="subtitle" id="subtitle">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å<br>–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–º —Å–ø–æ—Ä—Ç–µ</p>
        </div>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º -->
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('home')" id="home-tab-btn">–ì–ª–∞–≤–Ω–∞—è</button>
            <button class="tab-button" onclick="showTab('players')" id="players-tab-btn">–ò–≥—Ä–æ–∫–∏</button>
            <button class="tab-button" onclick="showTab('matches')" id="matches-tab-btn">–ú–∞—Ç—á–∏</button>
        </div>
        
        <div class="content">
            <!-- –í–∫–ª–∞–¥–∫–∞ –ì–ª–∞–≤–Ω–∞—è -->
            <div id="home-tab" class="tab-content active">
                <div class="section">
                    <div class="season-header">
                        <h3>–°–µ–∑–æ–Ω <span id="current-season">1</span></h3>
                        <button class="btn btn-primary" onclick="startNewSeason()">–ù–æ–≤—ã–π —Å–µ–∑–æ–Ω</button>
                    </div>
                </div>
                
                <div class="section">
                    <div id="stats-container">
                        <div class="stat-item">
                            <span class="stat-label" id="total-players-label">–ò–≥—Ä–æ–∫–æ–≤:</span>
                            <span class="stat-value" id="total-players">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" id="total-matches-label">–ú–∞—Ç—á–µ–π:</span>
                            <span class="stat-value" id="total-matches">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label" id="average-rating-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥:</span>
                            <span class="stat-value" id="average-rating">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h3 id="top-players-title">–¢–æ–ø –∏–≥—Ä–æ–∫–∏</h3>
                    <div id="top-players">
                        <!-- –¢–æ–ø –∏–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <div class="section">
                    <button class="btn btn-success btn-export" onclick="exportData()">–≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤</button>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –ò–≥—Ä–æ–∫–∏ -->
            <div id="players-tab" class="tab-content">
                <div class="section">
                    <h3>–ò–≥—Ä–æ–∫–∏</h3>
                    <div class="table-container">
                        <div id="players-list">
                            <!-- –ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addPlayer()">–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</button>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –ú–∞—Ç—á–∏ -->
            <div id="matches-tab" class="tab-content">
            
            <div class="section">
                <h3>–ù–æ–≤—ã–π –º–∞—Ç—á</h3>
                
                <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞ -->
                <div style="margin-bottom: 20px;">
                    <h4 id="calculation-params-title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞</h4>
                    <div id="calculation-params" class="calculation-params">
                        <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ -->
                <div class="available-players">
                    <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä–æ–∫–∏</h3>
                    <div id="available-players-list" class="player-list">
                        <!-- –ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
                
                <!-- –ö–æ–º–∞–Ω–¥—ã -->
                <div class="teams-section">
                    <div class="teams-container">
                        <div class="team-section team-a">
                            <div class="team-title">–ö–æ–º–∞–Ω–¥–∞ A</div>
                            <div id="team-a-players" class="team-players">
                            </div>
                            <div id="team-a-stats" class="team-stats">
                                <div class="team-total-rating">–°—É–º–º–∞: 0</div>
                                <div class="team-change-display" id="team-a-change" style="display: none;"></div>
                            </div>
                        </div>
                        
                        <div class="team-section team-b">
                            <div class="team-title">–ö–æ–º–∞–Ω–¥–∞ B</div>
                            <div id="team-b-players" class="team-players">
                            </div>
                            <div id="team-b-stats" class="team-stats">
                                <div class="team-total-rating">–°—É–º–º–∞: 0</div>
                                <div class="team-change-display" id="team-b-change" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –°—á–µ—Ç –∏ –∫–Ω–æ–ø–∫–∞ -->
                <div class="form-group">
                    <label for="score-a" id="score-label" style="text-align: center; display: block;">–°—á–µ—Ç</label>
                    <div style="display: flex; gap: 10px; justify-content: center; align-items: center;">
                        <input type="number" id="score-a" placeholder="0" min="0" max="99" style="flex: 1; text-align: center;" class="no-spinner">
                        <span style="font-size: 18px; font-weight: bold;">:</span>
                        <input type="number" id="score-b" placeholder="0" min="0" max="99" style="flex: 1; text-align: center;" class="no-spinner">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="calculateMatch()" style="width: 100%; margin-top: 10px;">–í–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞</button>
            </div>
            
                <!-- –ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π -->
                <div class="section">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π</h3>
                    <div id="matches-history">
                        <!-- –ú–∞—Ç—á–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div> <!-- –ó–∞–∫—Ä—ã–≤–∞–µ–º app-container -->
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ -->
    <div id="add-player-modal" class="modal">
        <div class="modal-content">
            <h3>–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</h3>
            <div class="form-group">
                <label for="player-name">–ò–º—è –∏–≥—Ä–æ–∫–∞ (–º–∞–∫—Å. 10 —Å–∏–º–≤–æ–ª–æ–≤):</label>
                <input type="text" id="player-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" maxlength="10">
            </div>
            <div class="form-group">
                <label for="player-rating">–ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥:</label>
                <input type="number" id="player-rating" value="1500" min="1000" max="2000" class="no-spinner">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-cancel" onclick="hideAddPlayerModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="addPlayerFromModal()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>
    
    <script>
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let players = [];
        let matches = [];
        let teamA = [];
        let teamB = [];
        let selectedPlayer = null;
        let currentSeason = 1;
        let currentUser = 'Test1';
        let seasonStartRatings = {}; // –†–µ–π—Ç–∏–Ω–≥–∏ –Ω–∞ –Ω–∞—á–∞–ª–æ —Å–µ–∑–æ–Ω–∞
        let currentLanguage = 'ru'; // –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
        
        // –ü–µ—Ä–µ–≤–æ–¥—ã
        const translations = {
            ru: {
                title: 'üèÜ –¢–æ–ø–†–µ–π—Ç',
                subtitle: '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å<br>–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–º —Å–ø–æ—Ä—Ç–µ',
                logout: '–í—ã—Ö–æ–¥',
                home: '–ì–ª–∞–≤–Ω–∞—è',
                players: '–ò–≥—Ä–æ–∫–∏',
                matches: '–ú–∞—Ç—á–∏',
                season: '–°–µ–∑–æ–Ω',
                newSeason: '–ù–æ–≤—ã–π —Å–µ–∑–æ–Ω',
                guest: '–ì–æ—Å—Ç—å',
                username: '–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:',
                password: '–ü–∞—Ä–æ–ª—å:',
                login: '–í–æ–π—Ç–∏',
                enterUsername: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
                enterPassword: '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å',
                addPlayer: '–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞',
                playerName: '–ò–º—è –∏–≥—Ä–æ–∫–∞ (–º–∞–∫—Å. 10 —Å–∏–º–≤–æ–ª–æ–≤)',
                initialRating: '–ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥',
                cancel: '–û—Ç–º–µ–Ω–∞',
                add: '–î–æ–±–∞–≤–∏—Ç—å',
                score: '–°—á–µ—Ç',
                enterResult: '–í–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞',
                availablePlayers: '–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä–æ–∫–∏',
                teamA: '–ö–æ–º–∞–Ω–¥–∞ –ê',
                teamB: '–ö–æ–º–∞–Ω–¥–∞ –ë',
                noPlayers: '–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤',
                playersCount: '–ò–≥—Ä–æ–∫–æ–≤',
                rating: '–†–µ–π—Ç–∏–Ω–≥',
                ratingChange: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ',
                matchesPlayed: '–ò–≥—Ä—ã',
                seasonChange: '–ó–∞ —Å–µ–∑–æ–Ω',
                editPlayer: '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞',
                newName: '–ù–æ–≤–æ–µ –∏–º—è (–º–∞–∫—Å. 10 —Å–∏–º–≤–æ–ª–æ–≤)',
                save: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å',
                delete: '–£–¥–∞–ª–∏—Ç—å',
                confirmDelete: '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞',
                confirmNewSeason: '–ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ–∑–æ–Ω? –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ–∑–æ–Ω–∞ –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω–∞, –Ω–æ —Ä–µ–π—Ç–∏–Ω–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è.',
                matchSaved: '–ú–∞—Ç—á —É—á—Ç–µ–Ω',
                nameChanged: '–ò–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–æ',
                playerDeleted: '–ò–≥—Ä–æ–∫ —É–¥–∞–ª–µ–Ω',
                enterName: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞',
                nameTooLong: '–ò–º—è –∏–≥—Ä–æ–∫–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–ª–∏–Ω–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤',
                nameExists: '–ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',
                enterRating: '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ (1000-2000)',
                helpTitle: '–°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤',
                helpText: '–ü–æ–±–µ–¥–∞ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–∑–Ω–∞—á–∞–µ—Ç +–æ—á–∫–∏, –ø–æ—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–∑–Ω–∞—á–∞–µ—Ç -–æ—á–∫–∏. –†–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∏–ª—ã –∫–æ–º–∞–Ω–¥—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞.',
                seasonLabel: '–°–µ–∑–æ–Ω',
                totalPlayers: '–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤',
                totalMatches: '–í—Å–µ–≥–æ –º–∞—Ç—á–µ–π',
                averageRating: '–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥',
                exportPlayers: '–≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤',
                availablePlayers: '–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä–æ–∫–∏',
                matchHistory: '–ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π',
                addPlayerModal: '–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞',
                noPlayers: '–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤',
                playersWillBeLoaded: '–ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏',
                playersWillBeAdded: '–ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript',
                matchesWillBeAdded: '–ú–∞—Ç—á–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript',
                seasonStarted: '–°–µ–∑–æ–Ω {season} –Ω–∞—á–∞—Ç! –†–µ–π—Ç–∏–Ω–≥–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±—Ä–æ—à–µ–Ω–∞.',
                teamAPlayers: '–ò–≥—Ä–æ–∫–∏ –∫–æ–º–∞–Ω–¥—ã A',
                teamBPlayers: '–ò–≥—Ä–æ–∫–∏ –∫–æ–º–∞–Ω–¥—ã B',
                sumA: '–°—É–º–º–∞ A (–≤—Ä—É—á–Ω—É—é)',
                sumB: '–°—É–º–º–∞ B (–≤—Ä—É—á–Ω—É—é)',
                exportData: '–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö',
                totalPlayers: '–ò–≥—Ä–æ–∫–æ–≤',
                totalMatches: '–ú–∞—Ç—á–µ–π',
                averageRating: '–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥',
                topPlayers: '–¢–æ–ø –ò–≥—Ä–æ–∫–∏',
                newMatch: '–ù–æ–≤—ã–π –º–∞—Ç—á',
                calculationParams: '–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞',
                teamASum: '–°—É–º–º–∞',
                teamBSum: '–°—É–º–º–∞',
                matchResult: '–í–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞',
                tableHeaders: {
                    rank: '‚Ññ',
                    name: '–ò–º—è',
                    ratingBefore: '–î–æ',
                    change: '+/-',
                    currentRating: '–ü–æ—Å–ª–µ',
                    games: '–ò–≥—Ä—ã',
                    seasonChange: '–°–µ–∑–æ–Ω'
                },
                messages: {
                    playerNotFound: '–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω',
                    enterPlayerName: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞',
                    nameTooLong: '–ò–º—è –∏–≥—Ä–æ–∫–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–ª–∏–Ω–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤',
                    nameExists: '–ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',
                    enterCorrectRating: '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ (1000-2000)',
                    playerNameChanged: '–ò–º—è –∏–≥—Ä–æ–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–æ',
                    playerDeleted: '–ò–≥—Ä–æ–∫ —É–¥–∞–ª–µ–Ω',
                    confirmDeletePlayer: '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞',
                    actionCannotBeUndone: '–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å',
                    matchRecorded: '–ú–∞—Ç—á —É—á—Ç–µ–Ω',
                    noPlayersToExport: '–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞',
                    seasonStarted: '–°–µ–∑–æ–Ω {season} –Ω–∞—á–∞—Ç! –†–µ–π—Ç–∏–Ω–≥–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±—Ä–æ—à–µ–Ω–∞.',
                    confirmNewSeason: '–ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ–∑–æ–Ω? –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ–∑–æ–Ω–∞ –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω–∞, –Ω–æ —Ä–µ–π—Ç–∏–Ω–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è.',
                    addPlayersToBothTeams: '–î–æ–±–∞–≤—å—Ç–µ –∏–≥—Ä–æ–∫–æ–≤ –≤ –æ–±–µ –∫–æ–º–∞–Ω–¥—ã'
                },
                calculationParams: {
                    title: '–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞:',
                    rd: 'RD (—Ä–∞–∑–Ω–æ—Å—Ç—å —Ä–µ–π—Ç–∏–Ω–≥–æ–≤):',
                    es: 'ES (–æ–∂–∏–¥–∞–µ–º—ã–π —Å—á–µ—Ç):',
                    gv: 'GV (—Ü–µ–Ω–∞ –≥–æ–ª–∞):',
                    ev: 'EV (–¥–æ–±–∞–≤–∫–∞):'
                },
                teamHeaders: {
                    teamA: '–ö–æ–º–∞–Ω–¥–∞ A',
                    teamB: '–ö–æ–º–∞–Ω–¥–∞ B',
                    sum: '–°—É–º–º–∞',
                    score: '–°—á–µ—Ç'
                }
            },
            en: {
                title: 'üèÜ TopRate',
                subtitle: 'Individual progress<br>in team sports',
                logout: 'Logout',
                home: 'Home',
                players: 'Players',
                matches: 'Matches',
                season: 'Season',
                newSeason: 'New Season',
                guest: 'Guest',
                username: 'Username:',
                password: 'Password:',
                login: 'Login',
                enterUsername: 'Enter username',
                enterPassword: 'Enter password',
                addPlayer: 'Add Player',
                playerName: 'Player Name (max 10 chars)',
                initialRating: 'Initial Rating',
                cancel: 'Cancel',
                add: 'Add',
                score: 'Score',
                enterResult: 'Enter Match Result',
                availablePlayers: 'Available Players',
                teamA: 'Team A',
                teamB: 'Team B',
                noPlayers: 'No Players',
                playersCount: 'Players',
                rating: 'Rating',
                ratingChange: 'Change',
                matchesPlayed: 'Games',
                seasonChange: 'Season',
                editPlayer: 'Edit Player',
                newName: 'New Name (max 10 chars)',
                save: 'Save',
                delete: 'Delete',
                confirmDelete: 'Are you sure you want to delete player',
                confirmNewSeason: 'Start new season? Season statistics will be reset, but ratings will be preserved.',
                matchSaved: 'Match recorded',
                nameChanged: 'Player name changed',
                playerDeleted: 'Player deleted',
                enterName: 'Enter player name',
                nameTooLong: 'Player name cannot be longer than 10 characters',
                nameExists: 'Player with this name already exists',
                enterRating: 'Enter correct rating (1000-2000)',
                helpTitle: 'Rating System',
                helpText: 'Victory does not always mean +points, defeat does not always mean -points. Rating depends on team strength and match result.',
                seasonLabel: 'Season',
                totalPlayers: 'Total Players',
                totalMatches: 'Total Matches',
                averageRating: 'Average Rating',
                exportPlayers: 'Export Players List',
                availablePlayers: 'Available Players',
                matchHistory: 'Match History',
                addPlayerModal: 'Add Player',
                noPlayers: 'No Players',
                playersWillBeLoaded: 'Players will be loaded dynamically',
                playersWillBeAdded: 'Players will be added via JavaScript',
                matchesWillBeAdded: 'Matches will be added via JavaScript',
                seasonStarted: 'Season {season} started! Ratings preserved, statistics reset.',
                teamAPlayers: 'Team A Players',
                teamBPlayers: 'Team B Players',
                sumA: 'Sum A (manually)',
                sumB: 'Sum B (manually)',
                exportData: 'Export Data',
                totalPlayers: 'Players',
                totalMatches: 'Matches',
                averageRating: 'Average Rating',
                topPlayers: 'Top Players',
                newMatch: 'New Match',
                calculationParams: 'Calculation Parameters',
                teamASum: 'Sum',
                teamBSum: 'Sum',
                matchResult: 'Enter Match Result',
                tableHeaders: {
                    rank: '#',
                    name: 'Name',
                    ratingBefore: 'Before',
                    change: '+/-',
                    currentRating: 'After',
                    games: 'Games',
                    seasonChange: 'Season'
                },
                messages: {
                    playerNotFound: 'Player not found',
                    enterPlayerName: 'Enter player name',
                    nameTooLong: 'Player name cannot be longer than 10 characters',
                    nameExists: 'Player with this name already exists',
                    enterCorrectRating: 'Enter correct rating (1000-2000)',
                    playerNameChanged: 'Player name changed',
                    playerDeleted: 'Player deleted',
                    confirmDeletePlayer: 'Are you sure you want to delete player',
                    actionCannotBeUndone: 'This action cannot be undone',
                    matchRecorded: 'Match recorded',
                    noPlayersToExport: 'No players to export',
                    seasonStarted: 'Season {season} started! Ratings preserved, statistics reset.',
                    confirmNewSeason: 'Start new season? Season statistics will be reset, but ratings will be preserved.',
                    addPlayersToBothTeams: 'Add players to both teams'
                },
                calculationParams: {
                    title: 'Calculation Parameters:',
                    rd: 'RD (rating difference):',
                    es: 'ES (expected score):',
                    gv: 'GV (goal value):',
                    ev: 'EV (bonus):'
                },
                teamHeaders: {
                    teamA: 'Team A',
                    teamB: 'Team B',
                    sum: 'Sum',
                    score: 'Score'
                }
            }
        };
        
        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–∞
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'ru' ? 'en' : 'ru';
            updateLanguage();
            updateLoginPage();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞
        function login() {
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value.trim();
            
            if (!username || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å');
                return;
            }
            
            // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –¥–µ–º–æ
            if (username && password) {
                currentUser = username;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const userNameElement = document.getElementById('user-name');
                if (userNameElement) {
                    userNameElement.textContent = username;
                }
                
                // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                document.getElementById('login-page').style.display = 'none';
                document.getElementById('app-container').style.display = 'block';
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                loadData();
                updatePlayersList();
                updateAvailablePlayers();
                updateTeamDisplays();
                updateMatchesHistory();
                updateStats();
                updateTopPlayers();
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞
        function updateLoginPage() {
            const t = translations[currentLanguage];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
            document.querySelector('.login-title').innerHTML = t.title;
            document.querySelector('.login-subtitle').innerHTML = t.subtitle;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∏ –ø–æ–ª–µ–π
            document.getElementById('login-username-label').textContent = t.username;
            document.getElementById('login-password-label').textContent = t.password;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã
            document.getElementById('login-username').placeholder = t.enterUsername;
            document.getElementById('login-password').placeholder = t.enterPassword;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            document.getElementById('login-btn').textContent = t.login;
            document.getElementById('login-language-btn').textContent = currentLanguage === 'ru' ? 'EN' : 'RU';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —è–∑—ã–∫–∞
        function updateLanguage() {
            const t = translations[currentLanguage];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            document.querySelector('.title').innerHTML = t.title;
            document.querySelector('.subtitle').innerHTML = t.subtitle;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            document.getElementById('logout-btn').textContent = t.logout;
            document.getElementById('language-btn').textContent = currentLanguage === 'ru' ? 'EN' : 'RU';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
            document.getElementById('home-tab-btn').textContent = t.home;
            document.getElementById('players-tab-btn').textContent = t.players;
            document.getElementById('matches-tab-btn').textContent = t.matches;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü
            updatePageContent();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü
        function updatePageContent() {
            const t = translations[currentLanguage];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ–∑–æ–Ω–∞
            const seasonHeader = document.querySelector('.season-header h3');
            if (seasonHeader) {
                const seasonNumber = document.getElementById('current-season').textContent;
                seasonHeader.innerHTML = `${t.seasonLabel} <span id="current-season">${seasonNumber}</span>`;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –Ω–æ–≤–æ–≥–æ —Å–µ–∑–æ–Ω–∞
            const newSeasonBtn = document.querySelector('[onclick="startNewSeason()"]');
            if (newSeasonBtn) {
                newSeasonBtn.textContent = t.newSeason;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            const statCards = document.querySelectorAll('.stat-card h3');
            if (statCards.length >= 3) {
                statCards[0].textContent = t.totalPlayers;
                statCards[1].textContent = t.totalMatches;
                statCards[2].textContent = t.averageRating;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            const totalPlayersLabel = document.getElementById('total-players-label');
            if (totalPlayersLabel) {
                totalPlayersLabel.textContent = t.totalPlayers + ':';
            }
            
            const totalMatchesLabel = document.getElementById('total-matches-label');
            if (totalMatchesLabel) {
                totalMatchesLabel.textContent = t.totalMatches + ':';
            }
            
            const averageRatingLabel = document.getElementById('average-rating-label');
            if (averageRatingLabel) {
                averageRatingLabel.textContent = t.averageRating + ':';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
            const exportBtns = document.querySelectorAll('[onclick="exportData()"]');
            exportBtns.forEach(btn => {
                if (btn.textContent.includes('—Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤')) {
                    btn.textContent = t.exportPlayers;
                } else {
                    btn.textContent = t.export;
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤–∫–ª–∞–¥–æ–∫
            const playersTitle = document.querySelector('#players-tab h3');
            if (playersTitle) {
                playersTitle.textContent = t.players;
            }
            
            const addPlayerBtn = document.querySelector('[onclick="addPlayer()"]');
            if (addPlayerBtn) {
                addPlayerBtn.textContent = t.addPlayer;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –º–∞—Ç—á–µ–π
            const availablePlayersTitle = document.querySelector('.available-players h3');
            if (availablePlayersTitle) {
                availablePlayersTitle.textContent = t.availablePlayers;
            }
            
            const teamATitle = document.querySelector('#team-a h3');
            if (teamATitle) {
                teamATitle.textContent = t.teamA;
            }
            
            const teamBTitle = document.querySelector('#team-b h3');
            if (teamBTitle) {
                teamBTitle.textContent = t.teamB;
            }
            
            const matchHistoryTitle = document.querySelector('#matches-history').previousElementSibling;
            if (matchHistoryTitle && matchHistoryTitle.tagName === 'H3') {
                matchHistoryTitle.textContent = t.matchHistory;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
            const addPlayerModal = document.querySelector('#add-player-modal h3');
            if (addPlayerModal) {
                addPlayerModal.textContent = t.addPlayerModal;
            }
            
            const playerNameLabel = document.querySelector('label[for="player-name"]');
            if (playerNameLabel) {
                playerNameLabel.textContent = t.playerName;
            }
            
            const initialRatingLabel = document.querySelector('label[for="player-rating"]');
            if (initialRatingLabel) {
                initialRatingLabel.textContent = t.initialRating;
            }
            
            const modalCancelBtn = document.querySelector('[onclick="hideAddPlayerModal()"]');
            if (modalCancelBtn) {
                modalCancelBtn.textContent = t.cancel;
            }
            
            const modalAddBtn = document.querySelector('[onclick="addPlayerFromModal()"]');
            if (modalAddBtn) {
                modalAddBtn.textContent = t.add;
            }
            
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–¢–æ–ø –ò–≥—Ä–æ–∫–∏"
            const topPlayersTitle = document.getElementById('top-players-title');
            if (topPlayersTitle) {
                topPlayersTitle.textContent = t.topPlayers;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–ù–æ–≤—ã–π –º–∞—Ç—á"
            const newMatchTitle = document.querySelector('#matches-tab h3');
            if (newMatchTitle && newMatchTitle.textContent.includes('–ù–æ–≤—ã–π –º–∞—Ç—á')) {
                newMatchTitle.textContent = t.newMatch;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞"
            const paramsTitle = document.querySelector('#calculation-params h3');
            if (paramsTitle) {
                paramsTitle.textContent = t.calculationParams;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ h4 "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞"
            const paramsH4 = document.querySelector('#calculation-params-title');
            if (paramsH4) {
                paramsH4.textContent = t.calculationParams.title;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–º–∞–Ω–¥
            const teamATitle2 = document.querySelector('.team-a .team-title');
            if (teamATitle2) {
                teamATitle2.textContent = t.teamHeaders.teamA;
            }
            
            const teamBTitle2 = document.querySelector('.team-b .team-title');
            if (teamBTitle2) {
                teamBTitle2.textContent = t.teamHeaders.teamB;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–æ–≤–æ "–°—É–º–º–∞" –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –∫–æ–º–∞–Ω–¥
            const teamASumTitle = document.querySelector('#team-a-stats .team-total-rating');
            if (teamASumTitle) {
                const currentValue = teamASumTitle.textContent.match(/\d+/);
                if (currentValue) {
                    teamASumTitle.textContent = `${t.teamHeaders.sum}: ${currentValue[0]}`;
                }
            }
            
            const teamBSumTitle = document.querySelector('#team-b-stats .team-total-rating');
            if (teamBSumTitle) {
                const currentValue = teamBSumTitle.textContent.match(/\d+/);
                if (currentValue) {
                    teamBSumTitle.textContent = `${t.teamHeaders.sum}: ${currentValue[0]}`;
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—á–µ—Ç–∞
            const scoreLabel = document.getElementById('score-label');
            if (scoreLabel) {
                scoreLabel.textContent = t.teamHeaders.score;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–í–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞"
            const matchResultBtn = document.querySelector('[onclick="calculateMatch()"]');
            if (matchResultBtn) {
                matchResultBtn.textContent = t.matchResult;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –∏–≥—Ä–æ–∫–æ–≤
            const tableHeaders = document.querySelectorAll('#players-list table th');
            if (tableHeaders.length >= 7) {
                console.log('–û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:', t.tableHeaders);
                tableHeaders[0].textContent = t.tableHeaders.rank;
                tableHeaders[1].textContent = t.tableHeaders.name;
                tableHeaders[2].textContent = t.tableHeaders.ratingBefore;
                tableHeaders[3].textContent = t.tableHeaders.change;
                tableHeaders[4].textContent = t.tableHeaders.currentRating;
                tableHeaders[5].textContent = t.tableHeaders.games;
                tableHeaders[6].textContent = t.tableHeaders.seasonChange;
                console.log('–ó–∞–≥–æ–ª–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–î–æ–±–∞–≤—å—Ç–µ –∏–≥—Ä–æ–∫–æ–≤ –≤ –æ–±–µ –∫–æ–º–∞–Ω–¥—ã" –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
            const paramsDiv = document.getElementById('calculation-params');
            if (paramsDiv && (paramsDiv.innerHTML.includes('–î–æ–±–∞–≤—å—Ç–µ –∏–≥—Ä–æ–∫–æ–≤ –≤ –æ–±–µ –∫–æ–º–∞–Ω–¥—ã') || paramsDiv.innerHTML.includes('Add players to both teams'))) {
                paramsDiv.innerHTML = `<p style="text-align: center; color: #666; font-style: italic;">${t.messages.addPlayersToBothTeams}</p>`;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —è–∑—ã–∫–∞
            updateTeamNames();
        }
        
        // –ù–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ —Å–µ–∑–æ–Ω–∞
        function startNewSeason() {
            console.log('startNewSeason –≤—ã–∑–≤–∞–Ω–∞');
            const t = translations[currentLanguage];
            if (confirm(t.confirmNewSeason)) {
                console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ —Å–µ–∑–æ–Ω–∞');
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¢–ï–ö–£–©–ò–ï —Ä–µ–π—Ç–∏–Ω–≥–∏ –∫–∞–∫ –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–µ–∑–æ–Ω–∞ –ü–ï–†–ï–î —Å–±—Ä–æ—Å–æ–º
                seasonStartRatings = {};
                players.forEach(player => {
                    seasonStartRatings[player.id] = player.rating; // –¢–ï–ö–£–©–ò–ô —Ä–µ–π—Ç–∏–Ω–≥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω—ã–º –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–µ–∑–æ–Ω–∞
                });
                console.log('–ù–∞—á–∞–ª—å–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ —Å–µ–∑–æ–Ω–∞ (–¢–ï–ö–£–©–ò–ï —Ä–µ–π—Ç–∏–Ω–≥–∏):', seasonStartRatings);
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¢–û–õ–¨–ö–û —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–µ–∑–æ–Ω–∞, –ù–ï —Ç—Ä–æ–≥–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥–∏
                players.forEach(player => {
                    console.log(`–°–ë–†–û–° –°–ï–ó–û–ù–ê: ${player.name} - lastRatingChange –î–û: ${player.lastRatingChange}`);
                    player.matchesPlayed = 0;
                    player.wins = 0;
                    player.losses = 0;
                    player.draws = 0;
                    player.goalsScored = 0;
                    player.goalsConceded = 0;
                    player.lastRatingChange = 0; // –°–ë–†–û–°: –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ç—á–∞ –æ–±–Ω—É–ª—è—é—Ç—Å—è
                    player.totalRatingGain = 0; // –°–ë–†–û–°: –ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞ —Å–µ–∑–æ–Ω –æ–±–Ω—É–ª—è—é—Ç—Å—è
                    console.log(`–°–ë–†–û–° –°–ï–ó–û–ù–ê: ${player.name} - lastRatingChange –ü–û–°–õ–ï: ${player.lastRatingChange}`);
                    // –†–ï–ô–¢–ò–ù–ì –ù–ï –¢–†–û–ì–ê–ï–ú - –æ–Ω –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –±—ã–ª –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏–≥—Ä—ã
                });
                
                console.log('–°–±—Ä–æ—Å —Å–µ–∑–æ–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω. seasonStartRatings:', seasonStartRatings);
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–æ–º–µ—Ä —Å–µ–∑–æ–Ω–∞
                currentSeason++;
                
                // –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –º–∞—Ç—á–µ–π
                matches = [];
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ (–≤–∫–ª—é—á–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ seasonStartRatings)
                saveData();
                
                console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–æ—Å–ª–µ –Ω–æ–≤–æ–≥–æ —Å–µ–∑–æ–Ω–∞. seasonStartRatings:', seasonStartRatings);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ü–û–°–õ–ï —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                updatePlayersList();
                updateAvailablePlayers();
                updateTeamDisplays();
                updateMatchesHistory();
                updateStats();
                updateTopPlayers();
                
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–∞
                document.getElementById('current-season').textContent = currentSeason;
                
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ò–≥—Ä–æ–∫–∏" –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
                showTab('players');
                
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É –µ—â–µ —Ä–∞–∑ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∏
                setTimeout(() => {
                    // –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï: seasonStartRatings —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã—à–µ
                    console.log('–ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï seasonStartRatings:', seasonStartRatings);
                    
                    // –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï: –û—á–∏—â–∞–µ–º –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
                    const container = document.getElementById('players-list');
                    if (container) {
                        // –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
                        container.innerHTML = '';
                        container.style.display = 'none';
                        container.style.visibility = 'hidden';
                        container.offsetHeight; // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow
                        
                        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                        updatePlayersList();
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
                        container.style.display = 'block';
                        container.style.visibility = 'visible';
                    }
                    
                    console.log('–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–æ');
                }, 200);
                
                alert(t.seasonStarted.replace('{season}', currentSeason));
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function saveData() {
            try {
                localStorage.setItem('toprate_players', JSON.stringify(players));
                localStorage.setItem('toprate_matches', JSON.stringify(matches));
                localStorage.setItem('toprate_season', currentSeason.toString());
                localStorage.setItem('toprate_season_start_ratings', JSON.stringify(seasonStartRatings));
                console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, seasonStartRatings:', seasonStartRatings);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function loadData() {
            try {
                const savedPlayers = localStorage.getItem('toprate_players');
                const savedMatches = localStorage.getItem('toprate_matches');
                const savedSeason = localStorage.getItem('toprate_season');
                
                if (savedPlayers) {
                    players = JSON.parse(savedPlayers);
                } else {
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                    players = [
                        { id: 1, name: '–ò–∏—Å—É—Å', rating: 1800, matchesPlayed: 0, wins: 0, losses: 0, draws: 0, goalsScored: 0, goalsConceded: 0, lastRatingChange: 0, totalRatingGain: 0 },
                        { id: 2, name: '–ú–∞—Ä–∏—è', rating: 1650, matchesPlayed: 0, wins: 0, losses: 0, draws: 0, goalsScored: 0, goalsConceded: 0, lastRatingChange: 0, totalRatingGain: 0 },
                        { id: 3, name: '–ò–æ–∞–Ω–Ω', rating: 1550, matchesPlayed: 0, wins: 0, losses: 0, draws: 0, goalsScored: 0, goalsConceded: 0, lastRatingChange: 0, totalRatingGain: 0 }
                    ];
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    saveData();
                }
                
                if (savedMatches) {
                    matches = JSON.parse(savedMatches);
                }
                
                if (savedSeason) {
                    currentSeason = parseInt(savedSeason);
                    document.getElementById('current-season').textContent = currentSeason;
                }
                
                // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º seasonStartRatings —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                const savedSeasonStartRatings = localStorage.getItem('toprate_season_start_ratings');
                if (savedSeasonStartRatings) {
                    seasonStartRatings = JSON.parse(savedSeasonStartRatings);
                    console.log('–ó–∞–≥—Ä—É–∂–µ–Ω—ã seasonStartRatings –∏–∑ localStorage:', seasonStartRatings);
                } else {
                    console.log('seasonStartRatings –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ localStorage, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏ (1500)');
                    seasonStartRatings = {};
                    players.forEach(player => {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ 1500, –∞ –Ω–µ —Ç–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥
                        seasonStartRatings[player.id] = 1500;
                    });
                    console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã seasonStartRatings —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏:', seasonStartRatings);
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ seasonStartRatings
                    saveData();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updatePlayersList();
            updateAvailablePlayers();
            updateTeamDisplays();
            updateMatchesHistory();
            updateStats();
            updateTopPlayers();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ —Å—á–µ—Ç–∞
            document.getElementById('score-a').addEventListener('input', updateTeamChangeDisplay);
            document.getElementById('score-b').addEventListener('input', updateTeamChangeDisplay);
        });
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º
        function showTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –∫–Ω–æ–ø–æ–∫
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => button.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.getElementById(tabName + '-tab-btn').classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
            if (tabName === 'home') {
                updateStats();
                updateTopPlayers();
            } else if (tabName === 'players') {
                updatePlayersList();
            } else if (tabName === 'matches') {
                updateAvailablePlayers();
                updateTeamDisplays();
                updateMatchesHistory();
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
        function updatePlayersList() {
            console.log('updatePlayersList –≤—ã–∑–≤–∞–Ω–∞, –∏–≥—Ä–æ–∫–æ–≤:', players.length);
            console.log('seasonStartRatings –î–û –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', seasonStartRatings);
            
            // –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï: –û–±–Ω–æ–≤–ª—è–µ–º seasonStartRatings —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
            // –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ seasonStartRatings –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
            let needsUpdate = false;
            players.forEach(player => {
                if (!seasonStartRatings[player.id]) {
                    // –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥
                    seasonStartRatings[player.id] = 1500;
                    needsUpdate = true;
                }
            });
            
            if (needsUpdate) {
                console.log('seasonStartRatings –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤:', seasonStartRatings);
                saveData();
            }
            
            console.log('seasonStartRatings –ü–û–°–õ–ï –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', seasonStartRatings);
            const container = document.getElementById('players-list');
            if (!container) {
                console.error('–≠–ª–µ–º–µ–Ω—Ç players-list –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            container.innerHTML = '';
            container.style.display = 'none';
            container.offsetHeight; // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow
            container.style.display = 'block';
            
            if (players.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤</p>';
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
            const table = document.createElement('table');
            table.className = 'players-table';
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
            const thead = document.createElement('thead');
            thead.innerHTML = `
                <tr>
                    <th>‚Ññ</th>
                    <th>–ò–º—è</th>
                    <th>–ë—ã–ª–æ</th>
                    <th>–ò–∑–º</th>
                    <th>–°—Ç–∞–ª–æ</th>
                    <th>–ò–≥—Ä—ã</th>
                    <th>–ó–∞ —Å–µ–∑–æ–Ω</th>
                </tr>
            `;
            table.appendChild(thead);
            
            // –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã
            const tbody = document.createElement('tbody');
            const sortedPlayers = [...players].sort((a, b) => b.rating - a.rating);
            
            sortedPlayers.forEach((player, index) => {
                // –†–µ–π—Ç–∏–Ω–≥ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ç—á–∞ (—Ç–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –º–∏–Ω—É—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ç—á–∞)
                const ratingBeforeLastGame = player.rating - player.lastRatingChange;
                
                // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ç—á–∞ (–Ω–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–µ)
                const lastMatchChange = player.lastRatingChange;
                const changeText = lastMatchChange > 0 ? `+${lastMatchChange}` : lastMatchChange < 0 ? `${lastMatchChange}` : '0';
                
                // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∑–∞ —Å–µ–∑–æ–Ω (—Ç–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –º–∏–Ω—É—Å —Ä–µ–π—Ç–∏–Ω–≥ –Ω–∞ –Ω–∞—á–∞–ª–æ —Å–µ–∑–æ–Ω–∞)
                const seasonStartRating = seasonStartRatings[player.id] || player.rating;
                const seasonChange = player.rating - seasonStartRating;
                const seasonChangeText = seasonChange > 0 ? `+${seasonChange}` : seasonChange < 0 ? `${seasonChange}` : '0';
                
                console.log(`–û–¢–õ–ê–î–ö–ê –¢–ê–ë–õ–ò–¶–´: ${player.name} - ratingBeforeLastGame=${ratingBeforeLastGame}, lastMatchChange=${lastMatchChange}, seasonStartRating=${seasonStartRating}, seasonChange=${seasonChange}`);
                
                console.log(`DEBUG: –ò–≥—Ä–æ–∫ ${player.name}: seasonStartRating=${seasonStartRating}, currentRating=${player.rating}, seasonChange=${seasonChange}`);
                console.log(`DEBUG: seasonStartRatings –¥–ª—è –∏–≥—Ä–æ–∫–∞ ${player.id}:`, seasonStartRatings[player.id]);
                console.log(`DEBUG: –ü–æ–ª–Ω—ã–π seasonStartRatings:`, seasonStartRatings);
                
                console.log(`–ò–≥—Ä–æ–∫ ${player.name}: —Ä–µ–π—Ç–∏–Ω–≥=${player.rating}, –Ω–∞—á–∞–ª–æ —Å–µ–∑–æ–Ω–∞=${seasonStartRating}, –∏–∑–º–µ–Ω–µ–Ω–∏–µ=${seasonChange}, –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–∞—Ç—á=${lastMatchChange}`);
                
                const row = document.createElement('tr');
                const displayName = player.name.length > 10 ? player.name.substring(0, 10) + '...' : player.name;
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td class="player-name-cell" onclick="editPlayer(${player.id})" style="cursor: pointer; color: #007bff; text-decoration: underline;" title="${player.name}">${displayName}</td>
                    <td>${ratingBeforeLastGame}</td>
                    <td class="${lastMatchChange > 0 ? 'positive' : lastMatchChange < 0 ? 'negative' : ''}">${changeText}</td>
                    <td>${player.rating}</td>
                    <td>${player.matchesPlayed}</td>
                    <td class="${seasonChange > 0 ? 'positive' : seasonChange < 0 ? 'negative' : ''}">${seasonChangeText}</td>
                `;
                tbody.appendChild(row);
            });
            
            table.appendChild(tbody);
            container.appendChild(table);
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            container.style.visibility = 'hidden';
            container.offsetHeight; // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow
            container.style.visibility = 'visible';
            
            console.log('–¢–∞–±–ª–∏—Ü–∞ –∏–≥—Ä–æ–∫–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
            const t = translations[currentLanguage];
            const tableHeaders = document.querySelectorAll('#players-list table th');
            if (tableHeaders.length >= 7) {
                console.log('–û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ updatePlayersList:', t.tableHeaders);
                tableHeaders[0].textContent = t.tableHeaders.rank;
                tableHeaders[1].textContent = t.tableHeaders.name;
                tableHeaders[2].textContent = t.tableHeaders.ratingBefore;
                tableHeaders[3].textContent = t.tableHeaders.change;
                tableHeaders[4].textContent = t.tableHeaders.currentRating;
                tableHeaders[5].textContent = t.tableHeaders.games;
                tableHeaders[6].textContent = t.tableHeaders.seasonChange;
            }
            
            updateAvailablePlayers();
            updateTeamDisplays();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
        function updateAvailablePlayers() {
            const availableList = document.getElementById('available-players-list');
            if (!availableList) {
                console.error('–≠–ª–µ–º–µ–Ω—Ç available-players-list –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            availableList.innerHTML = '';
            
            
            if (players.length === 0) {
                availableList.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤</p>';
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É (–æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É)
            const sortedPlayers = [...players].sort((a, b) => b.rating - a.rating);
            
            sortedPlayers.forEach((player, index) => {
                const isInTeamA = teamA.some(p => p.id === player.id);
                const isInTeamB = teamB.some(p => p.id === player.id);
                const isInAnyTeam = isInTeamA || isInTeamB;
                
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-item';
                playerDiv.innerHTML = `
                    <div class="player-item-info">
                        <div class="player-number">${index + 1}</div>
                        <div class="player-item-name" title="${player.name}">${player.name.length > 10 ? player.name.substring(0, 10) + '...' : player.name}</div>
                        <div class="player-item-rating">${player.rating}</div>
                    </div>
                    <div class="player-actions">
                        <button class="team-button team-a-button" 
                                onclick="addPlayerToTeam(${player.id}, 'A')"
                                ${isInAnyTeam ? 'disabled' : ''}>
                            A
                        </button>
                        <button class="team-button team-b-button" 
                                onclick="addPlayerToTeam(${player.id}, 'B')"
                                ${isInAnyTeam ? 'disabled' : ''}>
                            B
                        </button>
                    </div>
                `;
                availableList.appendChild(playerDiv);
            });
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –≤ –∫–æ–º–∞–Ω–¥—É
        function addPlayerToTeam(playerId, teamType) {
            const player = players.find(p => p.id === playerId);
            if (!player) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∏–≥—Ä–æ–∫ –Ω–µ –≤ –¥—Ä—É–≥–æ–π –∫–æ–º–∞–Ω–¥–µ
            const otherTeam = teamType === 'A' ? teamB : teamA;
            if (otherTeam.some(p => p.id === playerId)) {
                alert('–ò–≥—Ä–æ–∫ —É–∂–µ –≤ –¥—Ä—É–≥–æ–π –∫–æ–º–∞–Ω–¥–µ');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∏–≥—Ä–æ–∫ –Ω–µ –≤ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ
            const currentTeam = teamType === 'A' ? teamA : teamB;
            if (currentTeam.some(p => p.id === playerId)) {
                alert('–ò–≥—Ä–æ–∫ —É–∂–µ –≤ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ');
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ –∫–æ–º–∞–Ω–¥—É
            if (teamType === 'A') {
                teamA.push(player);
            } else {
                teamB.push(player);
            }
            
            updateAvailablePlayers();
            updateTeamDisplays();
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –∏–∑ –∫–æ–º–∞–Ω–¥—ã
        function removePlayerFromTeam(playerId, teamType) {
            if (teamType === 'A') {
                teamA = teamA.filter(p => p.id !== playerId);
            } else {
                teamB = teamB.filter(p => p.id !== playerId);
            }
            
            updateAvailablePlayers();
            updateTeamDisplays();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥
        function updateTeamDisplays() {
            updateTeamDisplay('A', teamA);
            updateTeamDisplay('B', teamB);
            updateTeamNames();
            updateTeamChangeDisplay();
            updateCalculationParams();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
        function updateTeamDisplay(teamType, team) {
            const playersContainer = document.getElementById(`team-${teamType.toLowerCase()}-players`);
            const statsContainer = document.getElementById(`team-${teamType.toLowerCase()}-stats`);
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            playersContainer.innerHTML = '';
            
            if (team.length > 0) {
                // –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
                const table = document.createElement('table');
                table.className = 'team-players-table';
                
                // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
                const thead = document.createElement('thead');
                thead.innerHTML = `
                    <tr>
                        <th>‚Ññ</th>
                        <th>–ò–º—è</th>
                        <th>–†–µ–π—Ç–∏–Ω–≥</th>
                        <th></th>
                    </tr>
                `;
                table.appendChild(thead);
                
                // –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã
                const tbody = document.createElement('tbody');
                team.forEach((player, index) => {
                    const shortName = player.name.length > 4 ? player.name.substring(0, 4) + '...' : player.name;
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td title="${player.name}">${shortName}</td>
                        <td>${player.rating}</td>
                        <td><button class="remove-player" onclick="removePlayerFromTeam(${player.id}, '${teamType}')">√ó</button></td>
                    `;
                    tbody.appendChild(row);
                });
                
                table.appendChild(tbody);
                playersContainer.appendChild(table);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const totalRating = team.reduce((sum, player) => sum + player.rating, 0);
            const totalRatingDiv = statsContainer.querySelector('.team-total-rating');
            if (totalRatingDiv) {
                const t = translations[currentLanguage];
                totalRatingDiv.textContent = `${t.teamHeaders.sum}: ${totalRating}`;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–æ–º–∞–Ω–¥ –ø–æ —Å–∞–º–æ–º—É —Å–∏–ª—å–Ω–æ–º—É –∏–≥—Ä–æ–∫—É
        function updateTeamNames() {
            const t = translations[currentLanguage];
            
            console.log('=== –û–¢–õ–ê–î–ö–ê updateTeamNames ===');
            console.log('teamA:', teamA);
            console.log('teamB:', teamB);
            console.log('currentLanguage:', currentLanguage);
            
            // –ö–æ–º–∞–Ω–¥–∞ A
            const teamATitle = document.querySelector('.team-a .team-title');
            if (teamA.length > 0) {
                const strongestPlayerA = teamA.reduce((max, player) => 
                    player.rating > max.rating ? player : max
                );
                const teamWord = currentLanguage === 'ru' ? '–ö–æ–º–∞–Ω–¥–∞' : 'Team';
                const newTitle = `${teamWord} ${strongestPlayerA.name}`;
                console.log('–ö–æ–º–∞–Ω–¥–∞ A - –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:', newTitle);
                teamATitle.textContent = newTitle;
            } else {
                console.log('–ö–æ–º–∞–Ω–¥–∞ A - –ø—É—Å—Ç–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫:', t.teamHeaders.teamA);
                teamATitle.textContent = t.teamHeaders.teamA;
            }
            
            // –ö–æ–º–∞–Ω–¥–∞ B
            const teamBTitle = document.querySelector('.team-b .team-title');
            if (teamB.length > 0) {
                const strongestPlayerB = teamB.reduce((max, player) => 
                    player.rating > max.rating ? player : max
                );
                const teamWord = currentLanguage === 'ru' ? '–ö–æ–º–∞–Ω–¥–∞' : 'Team';
                const newTitle = `${teamWord} ${strongestPlayerB.name}`;
                console.log('–ö–æ–º–∞–Ω–¥–∞ B - –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:', newTitle);
                teamBTitle.textContent = newTitle;
            } else {
                console.log('–ö–æ–º–∞–Ω–¥–∞ B - –ø—É—Å—Ç–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫:', t.teamHeaders.teamB);
                teamBTitle.textContent = t.teamHeaders.teamB;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        function updateTeamChangeDisplay() {
            const scoreA = parseInt(document.getElementById('score-a').value) || 0;
            const scoreB = parseInt(document.getElementById('score-b').value) || 0;
            
            if (teamA.length === 0 || teamB.length === 0) {
                // –°–∫—Ä—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã
                document.getElementById('team-a-change').style.display = 'none';
                document.getElementById('team-b-change').style.display = 'none';
                return;
            }
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞
            const teamAPlayers = teamA.map(p => players.find(player => player.id === p.id)).filter(p => p);
            const teamBPlayers = teamB.map(p => players.find(player => player.id === p.id)).filter(p => p);
            
            if (teamAPlayers.length === 0 || teamBPlayers.length === 0) return;
            
            const sumA = teamAPlayers.reduce((acc, p) => acc + p.rating, 0);
            const sumB = teamBPlayers.reduce((acc, p) => acc + p.rating, 0);
            
            let adjustedScoreA = scoreA;
            let adjustedScoreB = scoreB;
            if (scoreA === 0 && scoreB === 0) {
                // –†–∞–∑—Ä–µ—à–∞–µ–º –Ω–∏—á—å—é 0:0
                adjustedScoreA = 1;
                adjustedScoreB = 1;
            } else {
                // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–ª–µ–≤—ã–µ —Å—á–µ—Ç–∞
                if (adjustedScoreA === 0) adjustedScoreA = 1;
                if (adjustedScoreB === 0) adjustedScoreB = 1;
            }
            
            const isTeamAWinner = adjustedScoreA > adjustedScoreB;
            const winnerSum = isTeamAWinner ? sumA : sumB;
            const loserSum = isTeamAWinner ? sumB : sumA;
            const winnerScore = isTeamAWinner ? adjustedScoreA : adjustedScoreB;
            const loserScore = isTeamAWinner ? adjustedScoreB : adjustedScoreA;
            
            const RD = sumA - sumB;
            const totalPlayers = teamAPlayers.length + teamBPlayers.length;
            const ES = (RD / (totalPlayers / 2)) / 200 * 6;
            const goalDiff = adjustedScoreA - adjustedScoreB;
            const goalRatio = Math.min(adjustedScoreA, adjustedScoreB) / Math.max(adjustedScoreA, adjustedScoreB);
            
            // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: RGD –¥–æ–ª–∂–µ–Ω —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–Ω–æ—Å—Ç—å —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –¥–∞–∂–µ –ø—Ä–∏ –Ω–∏—á—å–µ–π
            let RGD;
            if (goalDiff === 0) {
                // –ü—Ä–∏ –Ω–∏—á—å–µ–π: —Å–∏–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Ç–µ—Ä—è–µ—Ç –æ—á–∫–∏, —Å–ª–∞–±–∞—è –ø–æ–ª—É—á–∞–µ—Ç
                RGD = -Math.abs(RD) / 100; // –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å–∏–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
            } else {
                // –ü—Ä–∏ –ø–æ–±–µ–¥–µ/–ø–æ—Ä–∞–∂–µ–Ω–∏–∏: —É—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–Ω–æ—Å—Ç—å –≥–æ–ª–æ–≤
                RGD = goalDiff * ((0.8 - goalRatio) + 1);
            }
            
            const GV = 7 * ((12 - totalPlayers) / 10 + 1);
            const TV = (totalPlayers / 2) * GV * (RGD - ES);
            
            // –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            console.log('=== –û–¢–õ–ê–î–ö–ê –†–ê–°–ß–ï–¢–ê ===');
            console.log('–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', { sumA, sumB, scoreA, scoreB, adjustedScoreA, adjustedScoreB });
            console.log('–ò–≥—Ä–æ–∫–∏ –∫–æ–º–∞–Ω–¥—ã A:', teamAPlayers.map(p => ({ name: p.name, rating: p.rating })));
            console.log('–ò–≥—Ä–æ–∫–∏ –∫–æ–º–∞–Ω–¥—ã B:', teamBPlayers.map(p => ({ name: p.name, rating: p.rating })));
            console.log('–°—É–º–º–∞ A (–≤—Ä—É—á–Ω—É—é):', teamAPlayers.reduce((acc, p) => acc + p.rating, 0));
            console.log('–°—É–º–º–∞ B (–≤—Ä—É—á–Ω—É—é):', teamBPlayers.reduce((acc, p) => acc + p.rating, 0));
            console.log('–§–æ—Ä–º—É–ª—ã:');
            console.log('RD = sumA - sumB =', sumA, '-', sumB, '=', RD);
            console.log('–ü—Ä–æ–≤–µ—Ä–∫–∞: 2379 - 1945 =', 2379 - 1945);
            console.log('–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö: sumA =', typeof sumA, ', sumB =', typeof sumB);
            console.log('–ó–Ω–∞—á–µ–Ω–∏—è: sumA =', sumA, ', sumB =', sumB);
            console.log('ES = (RD / (totalPlayers / 2)) / 200 * 6 = (', RD, '/', (totalPlayers / 2), ') / 200 * 6 =', ES);
            console.log('goalDiff = adjustedScoreA - adjustedScoreB =', adjustedScoreA, '-', adjustedScoreB, '=', goalDiff);
            console.log('goalRatio = Math.min(adjustedScoreA, adjustedScoreB) / Math.max(adjustedScoreA, adjustedScoreB) =', Math.min(adjustedScoreA, adjustedScoreB), '/', Math.max(adjustedScoreA, adjustedScoreB), '=', goalRatio);
            console.log('RGD =', RGD, '(–ø—Ä–∏ –Ω–∏—á—å–µ–π: –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ = —Å–∏–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Ç–µ—Ä—è–µ—Ç –æ—á–∫–∏)');
            console.log('TV = (RGD - ES) =', RGD, '-', ES, '=', TV);
            console.log('–ö–æ–º–∞–Ω–¥–∞ A –ø–æ–ª—É—á–∞–µ—Ç:', TV > 0 ? '+' + TV : TV);
            console.log('–ö–æ–º–∞–Ω–¥–∞ B –ø–æ–ª—É—á–∞–µ—Ç:', TV > 0 ? '-' + TV : '+' + Math.abs(TV));
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥
            const teamATotalRating = teamAPlayers.reduce((acc, p) => acc + p.rating, 0);
            const teamBTotalRating = teamBPlayers.reduce((acc, p) => acc + p.rating, 0);
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞–∫–∞ TV
            const teamATotalChange = teamAPlayers.reduce((sum, player) => {
                const playerShare = player.rating / teamATotalRating;
                return sum + Math.round(TV * playerShare);
            }, 0);
            
            const teamBTotalChange = teamBPlayers.reduce((sum, player) => {
                const playerShare = player.rating / teamBTotalRating;
                return sum + Math.round(-TV * playerShare);
            }, 0);
            
            // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
            console.log('–û—Ç–ª–∞–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:', {
                teamATotalChange, teamBTotalChange, TV
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const teamAChangeDiv = document.getElementById('team-a-change');
            const teamBChangeDiv = document.getElementById('team-b-change');
            
            if (teamAChangeDiv) {
                teamAChangeDiv.style.display = 'block';
                teamAChangeDiv.textContent = teamATotalChange > 0 ? `+${teamATotalChange}` : `${teamATotalChange}`;
                teamAChangeDiv.className = `team-change-display ${teamATotalChange > 0 ? 'positive' : 'negative'}`;
            }
            
            if (teamBChangeDiv) {
                teamBChangeDiv.style.display = 'block';
                teamBChangeDiv.textContent = teamBTotalChange > 0 ? `+${teamBTotalChange}` : `${teamBTotalChange}`;
                teamBChangeDiv.className = `team-change-display ${teamBTotalChange > 0 ? 'positive' : 'negative'}`;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞
            updateCalculationParams();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∞—Å—á–µ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        function updateCalculationParams() {
            const paramsDiv = document.getElementById('calculation-params');
            
            if (teamA.length === 0 || teamB.length === 0) {
                const t = translations[currentLanguage];
                paramsDiv.innerHTML = `<p style="text-align: center; color: #666; font-style: italic;">${t.messages.addPlayersToBothTeams}</p>`;
                return;
            }
            
            const teamAPlayers = teamA.map(p => players.find(player => player.id === p.id)).filter(p => p);
            const teamBPlayers = teamB.map(p => players.find(player => player.id === p.id)).filter(p => p);
            
            if (teamAPlayers.length === 0 || teamBPlayers.length === 0) {
                const t = translations[currentLanguage];
                paramsDiv.innerHTML = `<p style="text-align: center; color: #666; font-style: italic;">${t.messages.addPlayersToBothTeams}</p>`;
                return;
            }
            
            const sumA = teamAPlayers.reduce((acc, p) => acc + p.rating, 0);
            const sumB = teamBPlayers.reduce((acc, p) => acc + p.rating, 0);
            
            const scoreA = parseInt(document.getElementById('score-a').value) || 0;
            const scoreB = parseInt(document.getElementById('score-b').value) || 0;
            
            let adjustedScoreA = scoreA;
            let adjustedScoreB = scoreB;
            if (scoreA === 0 && scoreB === 0) {
                // –†–∞–∑—Ä–µ—à–∞–µ–º –Ω–∏—á—å—é 0:0
                adjustedScoreA = 1;
                adjustedScoreB = 1;
            } else {
                // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–ª–µ–≤—ã–µ —Å—á–µ—Ç–∞
                if (adjustedScoreA === 0) adjustedScoreA = 1;
                if (adjustedScoreB === 0) adjustedScoreB = 1;
            }
            
            const RD = sumA - sumB;
            console.log('DEBUG: sumA =', sumA, ', sumB =', sumB, ', RD =', RD);
            const totalPlayers = teamAPlayers.length + teamBPlayers.length;
            const ES = (RD / (totalPlayers / 2)) / 200 * 6;
            const goalDiff = adjustedScoreA - adjustedScoreB;
            const goalRatio = Math.min(adjustedScoreA, adjustedScoreB) / Math.max(adjustedScoreA, adjustedScoreB);
            
            // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: RGD –¥–æ–ª–∂–µ–Ω —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–Ω–æ—Å—Ç—å —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –¥–∞–∂–µ –ø—Ä–∏ –Ω–∏—á—å–µ–π
            let RGD;
            if (goalDiff === 0) {
                // –ü—Ä–∏ –Ω–∏—á—å–µ–π: —Å–∏–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Ç–µ—Ä—è–µ—Ç –æ—á–∫–∏, —Å–ª–∞–±–∞—è –ø–æ–ª—É—á–∞–µ—Ç
                RGD = -Math.abs(RD) / 100; // –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å–∏–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
            } else {
                // –ü—Ä–∏ –ø–æ–±–µ–¥–µ/–ø–æ—Ä–∞–∂–µ–Ω–∏–∏: —É—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–Ω–æ—Å—Ç—å –≥–æ–ª–æ–≤
                RGD = goalDiff * ((0.8 - goalRatio) + 1);
            }
            
            const GV = 7 * ((12 - totalPlayers) / 10 + 1);
            const TV = (totalPlayers / 2) * GV * (RGD - ES);
            
            const t = translations[currentLanguage];
            let html = `
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.rd}</span>
                    <span class="param-value">${RD.toFixed(2)}</span>
                </div>
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.es}</span>
                    <span class="param-value">${ES.toFixed(2)}</span>
                </div>
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.gv}</span>
                    <span class="param-value">${GV.toFixed(2)}</span>
                </div>
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.ev}</span>
                    <span class="param-value">${TV.toFixed(2)}</span>
                </div>
            `;
            
            paramsDiv.innerHTML = html;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
        function addPlayer() {
            document.getElementById('add-player-modal').style.display = 'block';
            document.getElementById('player-name').focus();
        }
        
        // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function hideAddPlayerModal() {
            document.getElementById('add-player-modal').style.display = 'none';
            document.getElementById('player-name').value = '';
            document.getElementById('player-rating').value = '1500';
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –∏–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function addPlayerFromModal() {
            const name = document.getElementById('player-name').value.trim();
            const rating = parseInt(document.getElementById('player-rating').value);
            const t = translations[currentLanguage];
            
            if (!name) {
                alert(t.messages.enterPlayerName);
                return;
            }
            
            if (name.length > 10) {
                alert(t.messages.nameTooLong);
                return;
            }
            
            if (players.some(player => player.name.toLowerCase() === name.toLowerCase())) {
                alert(t.messages.nameExists);
                return;
            }
            
            if (isNaN(rating) || rating < 1000 || rating > 2000) {
                alert(t.messages.enterCorrectRating);
                return;
            }
            
            const newPlayer = {
                id: Date.now(),
                name: name,
                rating: rating,
                matchesPlayed: 0,
                wins: 0,
                losses: 0,
                draws: 0,
                goalsScored: 0,
                goalsConceded: 0,
                lastRatingChange: 0,
                totalRatingGain: 0
            };
            
            players.push(newPlayer);
            saveData();
            updatePlayersList();
            updateAvailablePlayers();
            updateTeamDisplays();
            updateStats();
            updateTopPlayers();
            hideAddPlayerModal();
            
            alert('–ò–≥—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
        }
        
        // –†–∞—Å—á–µ—Ç –º–∞—Ç—á–∞ —Å –≤–∞—à–µ–π —Ñ–æ—Ä–º—É–ª–æ–π
        function calculateMatch() {
            // –°–ë–†–û–°: –°–±—Ä–∞—Å—ã–≤–∞–µ–º lastRatingChange –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –ü–ï–†–ï–î –Ω–æ–≤—ã–º –º–∞—Ç—á–µ–º
            players.forEach(player => {
                player.lastRatingChange = 0;
            });
            
            const teamAIds = teamA.map(p => p.id);
            const teamBIds = teamB.map(p => p.id);
            const scoreA = parseInt(document.getElementById('score-a').value) || 0;
            const scoreB = parseInt(document.getElementById('score-b').value) || 0;
            
            if (teamAIds.length === 0 || teamBIds.length === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–æ–≤ –≤ –æ–±–µ –∫–æ–º–∞–Ω–¥—ã');
                return;
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            let adjustedScoreA = scoreA;
            let adjustedScoreB = scoreB;
            
            if (scoreA === 0 && scoreB === 0) {
                // –†–∞–∑—Ä–µ—à–∞–µ–º –Ω–∏—á—å—é 0:0
                adjustedScoreA = 1;
                adjustedScoreB = 1;
            } else {
                // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–ª–µ–≤—ã–µ —Å—á–µ—Ç–∞
                if (adjustedScoreA === 0) adjustedScoreA = 1;
                if (adjustedScoreB === 0) adjustedScoreB = 1;
            }
            
            // –í–∞—à–∞ —Ñ–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞
            const teamAPlayers = teamAIds.map(id => players.find(p => p.id === id)).filter(p => p);
            const teamBPlayers = teamBIds.map(id => players.find(p => p.id === id)).filter(p => p);
            
            const sumA = teamAPlayers.reduce((acc, p) => acc + p.rating, 0);
            const sumB = teamBPlayers.reduce((acc, p) => acc + p.rating, 0);
            console.log('DEBUG: –ü–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ sumA =', sumA, ', sumB =', sumB);
            
            // –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–æ–π A –∏ –∫–æ–º–∞–Ω–¥–æ–π B
            const RD = sumA - sumB;
            console.log('DEBUG: sumA =', sumA, ', sumB =', sumB, ', RD =', RD);
            const totalPlayers = teamAPlayers.length + teamBPlayers.length;
            const ES = (RD / (totalPlayers / 2)) / 200 * 6;
            const goalDiff = adjustedScoreA - adjustedScoreB;
            const goalRatio = Math.min(adjustedScoreA, adjustedScoreB) / Math.max(adjustedScoreA, adjustedScoreB);
            
            // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ RGD
            let RGD;
            if (goalDiff === 0) {
                // –ü—Ä–∏ –Ω–∏—á—å–µ–π: —Å–∏–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Ç–µ—Ä—è–µ—Ç –æ—á–∫–∏, —Å–ª–∞–±–∞—è –ø–æ–ª—É—á–∞–µ—Ç
                // –ï—Å–ª–∏ A —Å–∏–ª—å–Ω–µ–µ (RD > 0), —Ç–æ RGD < 0 (A —Ç–µ—Ä—è–µ—Ç –æ—á–∫–∏)
                // –ï—Å–ª–∏ B —Å–∏–ª—å–Ω–µ–µ (RD < 0), —Ç–æ RGD > 0 (B —Ç–µ—Ä—è–µ—Ç –æ—á–∫–∏)
                RGD = -Math.abs(RD) / 100;
            } else {
                // –ü—Ä–∏ –ø–æ–±–µ–¥–µ/–ø–æ—Ä–∞–∂–µ–Ω–∏–∏: RGD –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –¥–ª—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
                // –ï—Å–ª–∏ A –≤—ã–∏–≥—Ä–∞–ª–∞ (goalDiff > 0), —Ç–æ RGD > 0
                // –ï—Å–ª–∏ B –≤—ã–∏–≥—Ä–∞–ª–∞ (goalDiff < 0), —Ç–æ RGD < 0
                RGD = goalDiff * ((0.8 - goalRatio) + 1);
            }
            
            const GV = 7 * ((12 - totalPlayers) / 10 + 1);
            
            // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: TV –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –¥–ª—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            // –ï—Å–ª–∏ A –≤—ã–∏–≥—Ä–∞–ª–∞ (goalDiff > 0), —Ç–æ TV > 0 (A –ø–æ–ª—É—á–∞–µ—Ç +–æ—á–∫–∏)
            // –ï—Å–ª–∏ B –≤—ã–∏–≥—Ä–∞–ª–∞ (goalDiff < 0), —Ç–æ TV < 0 (A –ø–æ–ª—É—á–∞–µ—Ç -–æ—á–∫–∏, B –ø–æ–ª—É—á–∞–µ—Ç +–æ—á–∫–∏)
            const TV = (totalPlayers / 2) * GV * (RGD - ES);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            window.lastCalculationParams = {
                sumA: sumA,
                sumB: sumB,
                adjustedScoreA: adjustedScoreA,
                adjustedScoreB: adjustedScoreB,
                RD: RD,
                totalPlayers: totalPlayers,
                ES: ES,
                goalDiff: goalDiff,
                goalRatio: goalRatio,
                RGD: RGD,
                GV: GV,
                TV: TV
            };
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            const changes = {};
            
            // –î–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∫–æ–º–∞–Ω–¥—ã A (–ø–æ–ª—É—á–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ TV)
            const teamATotalRating = teamAPlayers.reduce((acc, p) => acc + p.rating, 0);
            teamAPlayers.forEach(player => {
                const playerShare = player.rating / teamATotalRating;
                const change = Math.round(TV * playerShare);
                changes[player.id] = change;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–π—Ç–∏–Ω–≥
                player.rating += change;
                player.lastRatingChange = change;
                player.totalRatingGain += change;
                player.matchesPlayed++;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞
                const isWinner = scoreA > scoreB;
                const isDraw = scoreA === scoreB;
                if (isWinner) {
                    player.wins++;
                } else if (isDraw) {
                    player.draws++;
                } else {
                    player.losses++;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥–æ–ª—ã
                player.goalsScored += scoreA;
                player.goalsConceded += scoreB;
            });
            
            // –î–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –∫–æ–º–∞–Ω–¥—ã B (–ø–æ–ª—É—á–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ -TV)
            const teamBTotalRating = teamBPlayers.reduce((acc, p) => acc + p.rating, 0);
            teamBPlayers.forEach(player => {
                const playerShare = player.rating / teamBTotalRating;
                const change = Math.round(-TV * playerShare);
                changes[player.id] = change;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–π—Ç–∏–Ω–≥
                player.rating += change;
                player.lastRatingChange = change;
                player.totalRatingGain += change;
                player.matchesPlayed++;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞
                const isWinner = scoreB > scoreA;
                const isDraw = scoreA === scoreB;
                if (isWinner) {
                    player.wins++;
                } else if (isDraw) {
                    player.draws++;
                } else {
                    player.losses++;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥–æ–ª—ã
                player.goalsScored += scoreB;
                player.goalsConceded += scoreA;
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞—Ç—á –≤ –∏—Å—Ç–æ—Ä–∏—é
            matches.push({
                id: Date.now(),
                teamA: teamAPlayers.map(p => p.id),
                teamB: teamBPlayers.map(p => p.id),
                scoreA: scoreA,
                scoreB: scoreB,
                date: new Date().toLocaleDateString(),
                changes: changes
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞
            document.getElementById('team-a-change').style.display = 'none';
            document.getElementById('team-b-change').style.display = 'none';
            
            // –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º lastRatingChange - –æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ
            // –°–±—Ä–æ—Å –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –º–∞—Ç—á–µ
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –º–∞—Ç—á —É—á—Ç–µ–Ω
            const t = translations[currentLanguage];
            alert(t.messages.matchRecorded);
            
            // –û—á–∏—â–∞–µ–º –∫–æ–º–∞–Ω–¥—ã
            teamA = [];
            teamB = [];
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            saveData();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            console.log('–û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å...');
            updatePlayersList();
            updateAvailablePlayers();
            updateTeamDisplays();
            updateMatchesHistory();
            updateStats();
            updateTopPlayers();
            console.log('–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–±–Ω–æ–≤–ª–µ–Ω');
        }
        
        // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞
        function showMatchResult(changes, teamA, teamB, scoreA, scoreB) {
            const resultDiv = document.getElementById('match-result');
            resultDiv.style.display = 'block';
            
            let html = `<strong>–†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞: ${scoreA} : ${scoreB}</strong><br><br>`;
            
            html += '<strong>–ò–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤:</strong><br>';
            
            [...teamA, ...teamB].forEach(player => {
                const change = changes[player.id] || 0;
                const changeClass = change > 0 ? 'rating-change' : 'rating-change negative';
                const displayName = player.name.length > 10 ? player.name.substring(0, 10) + '...' : player.name;
                html += `${displayName}: ${change > 0 ? '+' : ''}${change}<br>`;
            });
            
            resultDiv.innerHTML = html;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const totalPlayers = players.length;
            const totalMatches = matches.length;
            const averageRating = players.length > 0 
                ? Math.round(players.reduce((sum, p) => sum + p.rating, 0) / players.length)
                : 0;
            
            document.getElementById('total-players').textContent = totalPlayers;
            document.getElementById('total-matches').textContent = totalMatches;
            document.getElementById('average-rating').textContent = averageRating;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤
        function updateTopPlayers() {
            const topPlayersDiv = document.getElementById('top-players');
            topPlayersDiv.innerHTML = '';
            
            if (players.length === 0) {
                topPlayersDiv.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤</p>';
                return;
            }
            
            const sortedPlayers = [...players].sort((a, b) => b.rating - a.rating).slice(0, 3);
            
            sortedPlayers.forEach((player, index) => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-item';
                const displayName = player.name.length > 10 ? player.name.substring(0, 10) + '...' : player.name;
                playerDiv.innerHTML = `
                    <div class="player-item-info">
                        <div class="player-item-name" title="${player.name}">${index + 1}. ${displayName}</div>
                        <div class="player-item-rating">–†–µ–π—Ç–∏–Ω–≥: ${player.rating}</div>
                    </div>
                `;
                topPlayersDiv.appendChild(playerDiv);
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –º–∞—Ç—á–µ–π
        function updateMatchesHistory() {
            const historyDiv = document.getElementById('matches-history');
            historyDiv.innerHTML = '';
            
            if (matches.length === 0) {
                historyDiv.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">–ù–µ—Ç –º–∞—Ç—á–µ–π</p>';
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∞—Ç—á–∏ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–≤–µ—Ä—Ö—É)
            const reversedMatches = [...matches].reverse();
            
            reversedMatches.forEach((match, index) => {
                const matchDiv = document.createElement('div');
                matchDiv.className = 'match-item';
                
                const teamAPlayers = match.teamA.map(id => players.find(p => p.id === id)).filter(p => p);
                const teamBPlayers = match.teamB.map(id => players.find(p => p.id === id)).filter(p => p);
                
                // –ù–∞—Ö–æ–¥–∏–º —Å–∞–º–æ–≥–æ —Å–∏–ª—å–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥–µ –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è
                const strongestA = teamAPlayers.reduce((max, p) => p.rating > max.rating ? p : max, teamAPlayers[0]);
                const strongestB = teamBPlayers.reduce((max, p) => p.rating > max.rating ? p : max, teamBPlayers[0]);
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥
                const teamATotalChange = teamAPlayers.reduce((sum, p) => sum + (match.changes[p.id] || 0), 0);
                const teamBTotalChange = teamBPlayers.reduce((sum, p) => sum + (match.changes[p.id] || 0), 0);
                
                let html = `
                    <div class="match-compact">
                        <div class="match-date">${match.date}</div>
                        <div class="match-teams-compact">
                            <div class="team-compact">
                                <span class="team-name-compact">${strongestA ? strongestA.name : '–ö–æ–º–∞–Ω–¥–∞ A'}</span>
                                <span class="team-change ${teamATotalChange > 0 ? 'positive' : 'negative'}">${teamATotalChange > 0 ? '+' : ''}${teamATotalChange}</span>
                            </div>
                            <div class="match-score-compact">${match.scoreA} : ${match.scoreB}</div>
                            <div class="team-compact">
                                <span class="team-name-compact">${strongestB ? strongestB.name : '–ö–æ–º–∞–Ω–¥–∞ B'}</span>
                                <span class="team-change ${teamBTotalChange > 0 ? 'positive' : 'negative'}">${teamBTotalChange > 0 ? '+' : ''}${teamBTotalChange}</span>
                            </div>
                        </div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ç—á–∞
                if (index === 0) {
                    html += `
                        <div class="match-actions">
                            <button class="btn btn-danger btn-small" onclick="deleteLastMatch()">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                    `;
                }
                
                html += '</div>';
                matchDiv.innerHTML = html;
                historyDiv.appendChild(matchDiv);
            });
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ç—á–∞
        function deleteLastMatch() {
            if (matches.length === 0) {
                alert('–ù–µ—Ç –º–∞—Ç—á–µ–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è');
                return;
            }
            
            if (confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–∞—Ç—á? –†–µ–π—Ç–∏–Ω–≥–∏ –≤–µ—Ä–Ω—É—Ç—Å—è –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –¥–æ —ç—Ç–æ–≥–æ –º–∞—Ç—á–∞.')) {
                const lastMatch = matches[matches.length - 1];
                
                // –û—Ç–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
                Object.keys(lastMatch.changes).forEach(playerId => {
                    const player = players.find(p => p.id === parseInt(playerId));
                    if (player) {
                        const change = lastMatch.changes[playerId];
                        player.rating -= change;
                        player.totalRatingGain -= change;
                        player.lastRatingChange = 0;
                        player.matchesPlayed--;
                        
                        // –û—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                        if (lastMatch.scoreA > lastMatch.scoreB) {
                            // –ö–æ–º–∞–Ω–¥–∞ A –≤—ã–∏–≥—Ä–∞–ª–∞, –æ—Ç–º–µ–Ω—è–µ–º –ø–æ–±–µ–¥—ã/–ø–æ—Ä–∞–∂–µ–Ω–∏—è
                            const teamAPlayers = lastMatch.teamA.map(id => players.find(p => p.id === id)).filter(p => p);
                            const teamBPlayers = lastMatch.teamB.map(id => players.find(p => p.id === id)).filter(p => p);
                            
                            teamAPlayers.forEach(p => p.wins--);
                            teamBPlayers.forEach(p => p.losses--);
                        } else if (lastMatch.scoreB > lastMatch.scoreA) {
                            // –ö–æ–º–∞–Ω–¥–∞ B –≤—ã–∏–≥—Ä–∞–ª–∞, –æ—Ç–º–µ–Ω—è–µ–º –ø–æ–±–µ–¥—ã/–ø–æ—Ä–∞–∂–µ–Ω–∏—è
                            const teamAPlayers = lastMatch.teamA.map(id => players.find(p => p.id === id)).filter(p => p);
                            const teamBPlayers = lastMatch.teamB.map(id => players.find(p => p.id === id)).filter(p => p);
                            
                            teamAPlayers.forEach(p => p.losses--);
                            teamBPlayers.forEach(p => p.wins--);
                        } else {
                            // –ù–∏—á—å—è, –æ—Ç–º–µ–Ω—è–µ–º –Ω–∏—á—å–∏
                            const allPlayers = [...lastMatch.teamA, ...lastMatch.teamB].map(id => players.find(p => p.id === id)).filter(p => p);
                            allPlayers.forEach(p => p.draws--);
                        }
                        
                        // –û—Ç–º–µ–Ω—è–µ–º –≥–æ–ª—ã
                        const teamAPlayers = lastMatch.teamA.map(id => players.find(p => p.id === id)).filter(p => p);
                        const teamBPlayers = lastMatch.teamB.map(id => players.find(p => p.id === id)).filter(p => p);
                        
                        teamAPlayers.forEach(p => {
                            p.goalsScored -= lastMatch.scoreA;
                            p.goalsConceded -= lastMatch.scoreB;
                        });
                        
                        teamBPlayers.forEach(p => {
                            p.goalsScored -= lastMatch.scoreB;
                            p.goalsConceded -= lastMatch.scoreA;
                        });
                    }
                });
                
                // –£–¥–∞–ª—è–µ–º –º–∞—Ç—á –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
                matches.pop();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
                saveData();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                updatePlayersList();
                updateAvailablePlayers();
                updateTeamDisplays();
                updateMatchesHistory();
                updateStats();
                updateTopPlayers();
                
                alert('–ü–æ—Å–ª–µ–¥–Ω–∏–π –º–∞—Ç—á —É–¥–∞–ª–µ–Ω. –†–µ–π—Ç–∏–Ω–≥–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞
        function showCalculationParams() {
            const paramsDiv = document.getElementById('calculation-params');
            
            if (!window.lastCalculationParams) {
                alert('–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—á–µ—Ç –º–∞—Ç—á–∞');
                return;
            }
            
            const params = window.lastCalculationParams;
            const t = translations[currentLanguage];
            let html = `<h4>${t.calculationParams.title}</h4>`;
            
            html += `
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.rd}</span>
                    <span class="param-value">${params.RD.toFixed(2)}</span>
                </div>
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.es}</span>
                    <span class="param-value">${params.ES.toFixed(2)}</span>
                </div>
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.gv}</span>
                    <span class="param-value">${params.GV.toFixed(2)}</span>
                </div>
                <div class="param-item">
                    <span class="param-name">${t.calculationParams.ev}</span>
                    <span class="param-value">${params.TV.toFixed(2)}</span>
                </div>
            `;
            
            paramsDiv.innerHTML = html;
            paramsDiv.style.display = paramsDiv.style.display === 'none' ? 'block' : 'none';
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
        function logout() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
                // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤—Ö–æ–¥–∞
                document.getElementById('login-username').value = '';
                document.getElementById('login-password').value = '';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                document.getElementById('app-container').style.display = 'none';
                document.getElementById('login-page').style.display = 'flex';
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                currentUser = '';
                
                alert('–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞');
            }
        }
        
        // –î—É–±–ª–∏—Ä—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è startNewSeason —É–¥–∞–ª–µ–Ω–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—à–µ
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
        function editPlayer(playerId) {
            const player = players.find(p => p.id === playerId);
            if (!player) {
                alert('–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            showEditPlayerModal(player);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–≥—Ä–æ–∫–∞
        function showEditPlayerModal(player) {
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    padding: 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    min-width: 300px;
                    max-width: 500px;
                ">
                    <h3 style="margin-top: 0; color: #333;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞</h3>
                    <p style="margin: 10px 0; color: #666;">–ò–≥—Ä–æ–∫: <strong>${player.name}</strong></p>
                    
                    <div style="margin: 15px 0;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">–ù–æ–≤–æ–µ –∏–º—è (–º–∞–∫—Å. 10 —Å–∏–º–≤–æ–ª–æ–≤):</label>
                        <input type="text" id="edit-player-name" value="${player.name}" maxlength="10" style="
                            width: 100%;
                            padding: 8px;
                            border: 1px solid #ddd;
                            border-radius: 4px;
                            font-size: 14px;
                        ">
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button onclick="savePlayerEdit(${player.id})" style="
                            background: #007bff;
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 4px;
                            cursor: pointer;
                        ">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                        <button onclick="deletePlayerConfirm(${player.id})" style="
                            background: #dc3545;
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 4px;
                            cursor: pointer;
                        ">–£–¥–∞–ª–∏—Ç—å</button>
                        <button onclick="closeEditModal()" style="
                            background: #6c757d;
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 4px;
                            cursor: pointer;
                        ">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            setTimeout(() => {
                const input = document.getElementById('edit-player-name');
                if (input) {
                    input.focus();
                    input.select();
                }
            }, 100);
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
        function savePlayerEdit(playerId) {
            const newName = document.getElementById('edit-player-name').value.trim();
            const player = players.find(p => p.id === playerId);
            const t = translations[currentLanguage];
            
            if (!newName) {
                alert(t.messages.enterPlayerName);
                return;
            }
            
            if (newName.length > 10) {
                alert(t.messages.nameTooLong);
                return;
            }
            
            if (newName === player.name) {
                closeEditModal();
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∏–º—è –Ω–µ –∑–∞–Ω—è—Ç–æ
            if (players.some(p => p.id !== playerId && p.name.toLowerCase() === newName.toLowerCase())) {
                alert(t.messages.nameExists);
                return;
            }
            
            player.name = newName;
            saveData();
            updatePlayersList();
            updateAvailablePlayers();
            updateTeamDisplays();
            updateStats();
            updateTopPlayers();
            closeEditModal();
            alert(t.messages.playerNameChanged);
        }
        
        // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
        function deletePlayerConfirm(playerId) {
            const player = players.find(p => p.id === playerId);
            const t = translations[currentLanguage];
            if (confirm(`${t.messages.confirmDeletePlayer} "${player.name}"? ${t.messages.actionCannotBeUndone}.`)) {
                // –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –∏–∑ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
                teamA = teamA.filter(p => p.id !== playerId);
                teamB = teamB.filter(p => p.id !== playerId);
                
                // –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
                players = players.filter(p => p.id !== playerId);
                
                // –£–¥–∞–ª—è–µ–º –∏–∑ seasonStartRatings
                delete seasonStartRatings[playerId];
                
                // –£–¥–∞–ª—è–µ–º –º–∞—Ç—á–∏ —Å —É—á–∞—Å—Ç–∏–µ–º —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                matches = matches.filter(match => 
                    !match.teamA.includes(playerId) && !match.teamB.includes(playerId)
                );
                
                saveData();
                updatePlayersList();
                updateAvailablePlayers();
                updateTeamDisplays();
                updateMatchesHistory();
                updateStats();
                updateTopPlayers();
                closeEditModal();
                alert(t.messages.playerDeleted);
            }
        }
        
        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function closeEditModal() {
            const modal = document.querySelector('.modal');
            if (modal) {
                modal.remove();
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è deletePlayer —É–¥–∞–ª–µ–Ω–∞ - —É–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –≤ editPlayer
        
        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        function exportData() {
            const t = translations[currentLanguage];
            if (players.length === 0) {
                alert(t.messages.noPlayersToExport);
                return;
            }
            
            let exportText = `üèÜ –¢–û–ü–†–ï–ô–¢ - –°–ï–ó–û–ù ${currentSeason}\n\n`;
            exportText += `üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n`;
            exportText += `–ò–≥—Ä–æ–∫–æ–≤: ${players.length}\n`;
            exportText += `–ú–∞—Ç—á–µ–π: ${matches.length}\n`;
            exportText += `–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥: ${Math.round(players.reduce((sum, p) => sum + p.rating, 0) / players.length)}\n\n`;
            
            exportText += `üë• –†–ï–ô–¢–ò–ù–ì –ò–ì–†–û–ö–û–í:\n`;
            const sortedPlayers = [...players].sort((a, b) => b.rating - a.rating);
            sortedPlayers.forEach((player, index) => {
                const rank = index + 1;
                const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : `${rank}.`;
                const displayName = player.name.length > 10 ? player.name.substring(0, 10) + '...' : player.name;
                exportText += `${medal} ${displayName} - ${player.rating}\n`;
            });
            
            exportText += `\nüìÖ –ò–°–¢–û–†–ò–Ø –ú–ê–¢–ß–ï–ô:\n`;
            if (matches.length === 0) {
                exportText += `–ù–µ—Ç –º–∞—Ç—á–µ–π\n`;
            } else {
                matches.forEach((match, index) => {
                    const teamAPlayers = match.teamA.map(id => players.find(p => p.id === id)).filter(p => p);
                    const teamBPlayers = match.teamB.map(id => players.find(p => p.id === id)).filter(p => p);
                    exportText += `${index + 1}. ${teamAPlayers.map(p => p.name).join(', ')} ${match.scoreA}:${match.scoreB} ${teamBPlayers.map(p => p.name).join(', ')} (${match.date})\n`;
                });
            }
            
            // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
            const blob = new Blob([exportText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `toprate_season_${currentSeason}_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            const modal = document.getElementById('add-player-modal');
            if (event.target === modal) {
                hideAddPlayerModal();
            }
        }
    </script>
</body>
</html>
